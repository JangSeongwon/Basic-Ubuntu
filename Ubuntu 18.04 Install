
sudo apt update , upgrade

-Resolution-
sudo gedit /etc/default/grub
GRUB_GFXMODE=1920x1080
sudo update-grub
sudo reboot

-xenomai Install-

wget https://mirrors.edge.kernel.org/pub/linux/kernel/v4.x/linux-4.14.128.tar.gz
tar xf linux-4.14.128.tar.gz

wget https://xenomai.org/downloads/xenomai/stable/xenomai-3.0.9.tar.bz2
tar xf xenomai-3.0.9.tar.bz2

cd linux-4.14.128
wget https://xenomai.org/downloads/ipipe/v4.x/x86/ipipe-core-4.14.128-x86-5.patch
../xenomai-3.0.9/scripts/prepare-kernel.sh --arch=x86_64 --ipipe=ipipe-core-4.14.128-x86-5.patch

sudo make menuconfig

sudo CONCURRENCY_LEVEL=8 CLEAN_SOURCE=no fakeroot make-kpkg --initrd --append-to-version --revision kernel_image kernel_headers
or
grep -c processor /proc/cpuinfo 
sudo make-kpkg --J 12 --initrd --revision=1.0 kernel_image


sudo gedit .config (from linux4-xxx)
 CONFIG_SYSTEM_TRUSTED_KEYS="debian/canonical-certs.pem" 
 CONFIG_SYSTEM_TRUSTED_KEYS=""

-https://sourceexample.com/article/en/2b8da56187d81270d65df9015c5e308b/


-Adjusting Ubuntu booting for xenomai (Making sign for xenomai booting)
https://askubuntu.com/questions/1081472/vmlinuz-4-18-12-041812-generic-has-invalid-signature

1.make new config
# This definition stops the following lines failing if HOME isn't
# defined.
HOME                    = .
RANDFILE                = $ENV::HOME/.rnd 
[ req ]
distinguished_name      = req_distinguished_name
x509_extensions         = v3
string_mask             = utf8only
prompt                  = no

[ req_distinguished_name ]
countryName             = <YOURcountrycode>
stateOrProvinceName     = <YOURstate>
localityName            = <YOURcity>
0.organizationName      = <YOURorganization>
commonName              = Secure Boot Signing Key
emailAddress            = <YOURemail>

[ v3 ]
subjectKeyIdentifier    = hash
authorityKeyIdentifier  = keyid:always,issuer
basicConstraints        = critical,CA:FALSE
extendedKeyUsage        = codeSigning,1.3.6.1.4.1.311.10.3.6
nsComment               = "OpenSSL Generated Certificate"
2. openssl req -config ./mokconfig.cnf \
        -new -x509 -newkey rsa:2048 \
        -nodes -days 36500 -outform DER \
        -keyout "MOK.priv" \
        -out "MOK.der"
3. openssl x509 -in MOK.der -inform DER -outform PEM -out MOK.pem
4. sudo mokutil --import MOK.der
5. Reboot and Select "Enroll MOK" and then "View key". Make sure it is your key you created in step 2. 
Afterwards continue the process and you must enter the password which you provided in step 4. 
Continue with booting your system.
6. sudo mokutil --list-enrolled
7.sudo sbsign --key MOK.priv --cert MOK.pem /boot/vmlinuz-[KERNEL-VERSION]-surface-linux-surface --output /boot/vmlinuz-[KERNEL-VERSION]-surface-linux-surface.signed
8.sudo cp /boot/initrd.img-[KERNEL-VERSION]-surface-linux-surface{,.signed}
9.sudo update-grub
10.sudo mv /boot/vmlinuz-[KERNEL-VERSION]-surface-linux-surface{.signed,}
sudo mv /boot/initrd.img-[KERNEL-VERSION]-surface-linux-surface{.signed,}
sudo update-grub






